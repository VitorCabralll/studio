"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2336],{2336:(e,s,a)=>{a.r(s),a.d(s,{OCRProcessor:()=>E});var t=a(5155),r=a(8881),n=a(7936),i=a(5300),c=a(172),o=a(1133),l=a(8127),d=a(7607),m=a(5599),u=a(8718),x=a(2115),p=a(1046),g=a(2085),h=a(9434);let f=(0,g.F)("relative w-full rounded-lg border p-4 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),j=x.forwardRef((e,s)=>{let{className:a,variant:r,...n}=e;return(0,t.jsx)("div",{ref:s,role:"alert",className:(0,h.cn)(f({variant:r}),a),...n})});j.displayName="Alert",x.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("h5",{ref:s,className:(0,h.cn)("mb-1 font-medium leading-none tracking-tight",a),...r})}).displayName="AlertTitle";let v=x.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,h.cn)("text-sm [&_p]:leading-relaxed",a),...r})});v.displayName="AlertDescription";var N=a(6126),b=a(285),y=a(6695),w=a(4944),C=a(2346),R=a(8539),k=a(3364),z=a(9442);function E(e){let{onTextExtracted:s,onResults:a,maxFiles:g=5,language:h="por+eng",enableStructuredExtraction:f=!0}=e,[E,O]=(0,x.useState)([]),[A,P]=(0,x.useState)([]),[S,T]=(0,x.useState)(""),[_,F]=(0,x.useState)(null),[q,D]=(0,x.useState)(!1),{announce:B,AnnouncementRegion:I}=(0,k.v)(),{isProcessing:M,progress:$,error:L,processMultipleImages:W,extractCleanText:U,extractStructuredText:Z,cleanup:G}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{language:s="por+eng",enableWhitelist:a=!1,whitelist:t="",enableDeskew:r=!0,enableRotation:n=!0}=e,[i,c]=(0,x.useState)(!1),[o,l]=(0,x.useState)({status:"",progress:0,message:""}),[d,m]=(0,x.useState)(null),u=(0,x.useRef)(null),p=(0,x.useCallback)(async()=>{if(u.current)return u.current;try{let e=await (0,z.createWorker)(s,1,{logger:e=>{l({status:e.status,progress:e.progress,message:"recognizing text"===e.status?"Reconhecendo texto: ".concat(Math.round(100*e.progress),"%"):"loading language traineddata"===e.status?"Carregando modelo de linguagem...":"initializing tesseract"===e.status?"Inicializando OCR...":"initializing api"===e.status?"Configurando API...":"Processando..."})}});return await e.setParameters({tessedit_char_whitelist:a?t:void 0,preserve_interword_spaces:"1",tessedit_enable_dict_correction:"1"}),u.current=e,e}catch(s){let e=s instanceof Error?s.message:"Erro ao inicializar OCR";throw m(e),Error(e)}},[s,a,t,r]),g=(0,x.useCallback)(async e=>{c(!0),m(null),l({status:"initializing",progress:0,message:"Iniciando OCR..."});try{let s=await p();l({status:"preprocessing",progress:.1,message:"Pr\xe9-processando imagem..."});let a=await s.recognize(e);return l({status:"completed",progress:1,message:"OCR conclu\xeddo!"}),{text:a.data.text,confidence:a.data.confidence,words:[]}}catch(s){let e=s instanceof Error?"Erro no OCR: ".concat(s.message):"Erro desconhecido no processamento OCR";throw m(e),Error(e)}finally{c(!1)}},[p]),h=(0,x.useCallback)(async e=>{let s=[];for(let a=0;a<e.length;a++){let t=e[a];l({status:"processing",progress:a/e.length,message:"Processando imagem ".concat(a+1," de ").concat(e.length,"...")});let r=await g(t);s.push(r)}return s},[g]),f=(0,x.useCallback)(e=>e.text.replace(/\s+/g," ").replace(/\n+/g,"\n").trim(),[]);return{isProcessing:i,progress:o,error:d,processImage:g,processMultipleImages:h,extractCleanText:f,extractStructuredText:(0,x.useCallback)(e=>{let s=e.text,a={};return Object.entries({processo:/(?:processo\s*n[°º]?\s*[\d\-\.\/]+)/gi,vara:/(?:vara\s+[\w\s]+)/gi,comarca:/(?:comarca\s+de\s+[\w\s]+)/gi,cpf:/(?:\d{3}\.?\d{3}\.?\d{3}\-?\d{2})/g,cnpj:/(?:\d{2}\.?\d{3}\.?\d{3}\/?\d{4}\-?\d{2})/g,data:/(?:\d{1,2}\/\d{1,2}\/\d{4})/g,valor:/(?:R\$\s*[\d\.,]+)/gi}).forEach(e=>{let[t,r]=e,n=s.match(r);a[t]=n?[...new Set(n)]:[]}),{fullText:s,structured:a,confidence:e.confidence}},[]),cleanup:(0,x.useCallback)(async()=>{u.current&&(await u.current.terminate(),u.current=null)},[]),isWorkerReady:!!u.current}}({language:h}),V=(0,x.useCallback)(e=>{let s=e.filter(e=>e.type.startsWith("image/")||"application/pdf"===e.type);if(0===s.length)return void B("Nenhum arquivo de imagem v\xe1lido foi selecionado.");s.length>g?(B("M\xe1ximo de ".concat(g," arquivos permitidos. Selecionados apenas os primeiros ").concat(g,".")),P(s.slice(0,g))):(P(s),B("".concat(s.length," arquivo(s) selecionado(s) para OCR.")))},[g,B]),{getRootProps:J,getInputProps:X,isDragActive:H}=(0,p.VB)({onDrop:V,accept:{"image/*":[".png",".jpg",".jpeg",".gif",".bmp",".tiff"],"application/pdf":[".pdf"]},maxFiles:g,multiple:!0}),K=async()=>{if(0!==A.length)try{B("Iniciando processamento OCR...");let e=await W(A);O(e);let t=e.map(e=>U(e)).join("\n\n--- PR\xd3XIMO DOCUMENTO ---\n\n");if(T(t),f&&e.length>0){let s=Z(e[0]);F(s)}null==s||s(t,_),null==a||a(e),B("OCR conclu\xeddo! ".concat(e.length," documento(s) processado(s)."))}catch(e){console.error("Erro no processamento OCR:",e),B("Erro durante o processamento OCR.")}},Q=async()=>{try{await navigator.clipboard.writeText(S),B("Texto copiado para a \xe1rea de transfer\xeancia.")}catch(e){console.error("Erro ao copiar:",e),B("Erro ao copiar texto.")}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(I,{}),(0,t.jsxs)(y.Zp,{children:[(0,t.jsxs)(y.aR,{children:[(0,t.jsxs)(y.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(r.A,{className:"size-5"}),"OCR - Extra\xe7\xe3o de Texto Local"]}),(0,t.jsx)(y.BT,{children:"Extraia texto de imagens e PDFs diretamente no seu navegador. Seus documentos n\xe3o saem do seu computador."})]}),(0,t.jsxs)(y.Wu,{children:[(0,t.jsxs)("div",{...J(),className:"\n              cursor-pointer rounded-lg border-2 border-dashed p-8 text-center transition-colors\n              ".concat(H?"border-primary bg-primary/5":"border-border hover:border-primary/50","\n              ").concat(A.length>0?"bg-muted/30":"","\n            "),children:[(0,t.jsx)("input",{...X()}),(0,t.jsx)(n.A,{className:"mx-auto mb-4 size-12 text-muted-foreground"}),H?(0,t.jsx)("p",{className:"text-lg font-medium",children:"Solte os arquivos aqui..."}):(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"mb-2 text-lg font-medium",children:"Arraste imagens ou PDFs aqui, ou clique para selecionar"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Formatos suportados: PNG, JPG, JPEG, GIF, BMP, TIFF, PDF",g>1&&" (m\xe1ximo ".concat(g," arquivos)")]})]})]}),A.length>0&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h4",{className:"mb-2 font-medium",children:"Arquivos selecionados:"}),(0,t.jsx)("div",{className:"space-y-2",children:A.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-md bg-muted p-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(i.A,{className:"size-4"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:e.name}),(0,t.jsxs)(N.E,{variant:"secondary",children:[(e.size/1024/1024).toFixed(2)," MB"]})]}),(0,t.jsx)(b.$,{variant:"ghost",size:"sm",onClick:()=>P(e=>e.filter((e,a)=>a!==s)),"aria-label":"Remover ".concat(e.name),children:"\xd7"})]},s))})]}),(0,t.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,t.jsx)(b.$,{onClick:K,disabled:0===A.length||M,className:"flex-1",children:M?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.A,{className:"mr-2 size-4 animate-spin"}),"Processando..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.A,{className:"mr-2 size-4"}),"Extrair Texto (",A.length,")"]})}),E.length>0&&(0,t.jsx)(b.$,{variant:"outline",onClick:()=>{O([]),P([]),T(""),F(null),G(),B("Resultados limpos.")},children:"Limpar"})]})]})]}),M&&(0,t.jsx)(y.Zp,{children:(0,t.jsx)(y.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{children:"Progresso"}),(0,t.jsxs)("span",{children:[Math.round(100*$.progress),"%"]})]}),(0,t.jsx)(w.k,{value:100*$.progress}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:$.message})]})})}),L&&(0,t.jsxs)(j,{variant:"destructive",children:[(0,t.jsx)(o.A,{className:"size-4"}),(0,t.jsx)(v,{children:L})]}),E.length>0&&(0,t.jsxs)(y.Zp,{children:[(0,t.jsxs)(y.aR,{children:[(0,t.jsxs)(y.ZB,{className:"flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.A,{className:"size-5 text-green-600"}),"Texto Extra\xeddo"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(b.$,{variant:"outline",size:"sm",onClick:()=>D(!q),children:[(0,t.jsx)(d.A,{className:"mr-2 size-4"}),q?"Ocultar":"Visualizar"]}),(0,t.jsxs)(b.$,{variant:"outline",size:"sm",onClick:Q,children:[(0,t.jsx)(m.A,{className:"mr-2 size-4"}),"Copiar"]}),(0,t.jsxs)(b.$,{variant:"outline",size:"sm",onClick:()=>{let e=new Blob([S],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(e),a=document.createElement("a");a.href=s,a.download="texto-extraido-".concat(new Date().toISOString().split("T")[0],".txt"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),B("Download do texto iniciado.")},children:[(0,t.jsx)(u.A,{className:"mr-2 size-4"}),"Download"]})]})]}),(0,t.jsxs)(y.BT,{children:[E.length," documento(s) processado(s) • Confian\xe7a m\xe9dia: ",Math.round(E.reduce((e,s)=>e+s.confidence,0)/E.length),"%"]})]}),q&&(0,t.jsxs)(y.Wu,{children:[(0,t.jsx)(R.T,{value:S,onChange:e=>T(e.target.value),className:"min-h-64 font-mono text-sm",placeholder:"Texto extra\xeddo aparecer\xe1 aqui..."}),f&&_&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)(C.w,{className:"my-4"}),(0,t.jsx)("h4",{className:"mb-2 font-medium",children:"Dados Estruturados Detectados:"}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:Object.entries(_.structured).map(e=>{let[s,a]=e,r=Array.isArray(a)?a:[];return r.length>0&&(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("span",{className:"text-sm font-medium capitalize",children:[s,":"]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:r.map((e,s)=>(0,t.jsx)(N.E,{variant:"secondary",children:e},s))})]},s)})})]})]})]})]})}},2346:(e,s,a)=>{a.d(s,{w:()=>c});var t=a(5155),r=a(7489),n=a(2115),i=a(9434);let c=n.forwardRef((e,s)=>{let{className:a,orientation:n="horizontal",decorative:c=!0,...o}=e;return(0,t.jsx)(r.b,{ref:s,decorative:c,orientation:n,className:(0,i.cn)("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",a),...o})});c.displayName=r.b.displayName}}]);